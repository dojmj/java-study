## 자바 메모리 구조

- **메서드 영역 (Method Area)**
    - 프로그램을 실행하는데 필요한 공통 데이터를 관리 (프로그램의 모든 영역에서 공유)
    - 클래스 정보를 보관(붕어빵 틀을 보관) - 클래스의 실행코드, 필드, 메서드, 생성자 코드등 모든 코드
    - `static` 변수들을 보관
    - 런타임 상수 풀 - 프로그램을 실행하는데 필요한 공통 리터럴 상수 보관
- **스택 영역(Stack Area)**
    - 실제 프로그램이 실행되는 영역 (자바 실행 시 하나의 실행 스택 생성)
    - 메서드를 실행할 때마다 하나씩 쌓임 - 메서드 종료되면 해당 스택 프레임 제거됨
- **힙 영역(Heap Area)**
    - 객체(인스턴스)가 생성되는 영역
    - `new` 명령어를 사용하면 이 영역 사용 (+ 배열도 이 영역에 생성)
    - 가비지 컬렉션(GC)이 이루어지는 주요 영역

메서드 코드는 메서드 영역에.

→ 즉, 인스턴스의 메서드를 호출하면 실제로는 메서드 영역에 있는 코드를 불러서 수행

### 스택과 큐 자료구조

**후입 선출(LIFO, Last In First Out)**

→ 스택 / 넣는 곳과 빼는 곳이 같음. 드럼통 생각

**선입 선출(FIFO, First In First Out)**

→ 큐 / 먼저 들어간 게 먼저 나옴. 계산 줄이나 선착순 생각

```java
package memory;

public class JavaMemoryMain1 {
    public static void main(String[] args) {
        System.out.println("main start");
        method1(10);
        System.out.println("main end");
    }

    static void method1(int m1) {
        System.out.println("method1 start");
        int cal = m1 * 2;
        method2(cal);
        System.out.println("method1 end");
    }

    static void method2(int m2) {
        System.out.println("method2 start");
        System.out.println("method2 end");
    }
}
```

```java
main start
method1 start
method2 start
method2 end
method1 end
main end
```

→ 먼저 넣은 main이 나중에 나오는 스택 자료구조

**정리**

- 자바는 스택 영역을 사용해서 메서드 호출과 지역 변수(매개변수 포함)를 관리함
- 메서드를 계속 호출하면 스택 프레임이 계속 쌓임
- 스택 프레임이 종료되면 지역 변수도 함께 제거됨
- 스택 프레임이 모두 제거되면 프로그램도 종료됨
- **지역 변수는 스택 영역에, 객체(인스턴스)는 힙 영역에서 관리됨**

## static

- 클래스인 붕어빵 틀이 특별히 관리하는 변수. 붕어빵 틀은 1개이므로 클래스 변수도 하나만 존재.
- 특정 클래스에서 공용으로 함께 사용할 수 있는 변수
- 멤버 변수에 `static` 을 붙이게 되면 **`static` 변수**, **정적 변수** 또는 **클래스 변수**라 함
- `static` 변수는 메서드 영역에서 관리함. (힙 영역 아님)
- `static` 이 붙은 정적 변수에 접근하려면 `Data3.count` 와 같이 `클래스명+.(dot)+변수명` 으로 접근
    - 인스턴스를 통해서도 접근이 가능하지만 권장하지 않음. 왜냐, 코드를 읽을 때 마치 인스턴스 변수에 접근하는 것처럼 오해할 수 있기 때문.

### 용어 정리

```java
public class Data3 {
	public String name;
	public static int count; //static
}
```

**멤버 변수(필드)의 종류**

- **인스턴스 변수**: `static` 이 붙지 않은 멤버 변수, 위 코드에서는 `name`
    - 인스턴스 변수는 인스턴스를 생성해야 사용할 수 있고, 인스턴스에 소속되어 있음
    - 인스턴스 변수는 인스턴스를 만들 때 마다 새로 만들어짐
- **클래스 변수**: `static` 이 붙은 멤버 변수, 위 코드에서는 `count`
    - 클래스 변수, 정적 변수, `static` 변수 등으로 부름. 세 용어를 모두 사용하니 주의!
    - `static` 이 붙은 멤버 변수는 인스턴스와 무관하게 클래스에 바로 접근해서 사용 가능
    - 클래스 자체에 소속되어 있음
    - 클래스 변수는 자바 프로그램을 시작할 때 딱 1개가 만들어짐.

### 변수와 생명주기

- 지역 변수(매개변수 포함): 스택 영역에 있는 스택 프레임 안에 보관됨
    - 메서드가 종료되면 스택 프레임 제거됨. 이때 해당 스택 프레임에 포함된 지역 변수도 함께 제거됨
    - 따라서, 지역 변수는 생존 주기가 짧음
- 인스턴스 변수: 인스턴스에 있는 멤버 변수를 인스턴스 변수라 함. 힙 영역 사용.
    - 힙 영역은 GC(가비지 컬렉션)가 발생하기 전까지는 생존하기 때문에 보통 지역 변수보다 생존 주기가 긺
- 클래스 변수: 메서드 영역의 static 영역에 보관되는 변수. 메서드 영역은 프로그램 전체에서 사용하는 공용 공간.
    - 클래스 변수는 해당 클래스가 JVM에 로딩 되는 순간 생성. 그리고 JVM이 종료될 때 까지 생명 주기가 이어짐
    - 따라서, 생명주기가 가장 긺

→ `static` 변수가 정적인 이유: 힙 영역에 생성되는 인스턴스 변수는 동적으로 생성, 제거됨. 반면, `static` 변수는 거의 프로그램 실행 시점에 딱 만들어지고, 프로그램 종료 시점에 종료됨. 이름 그대로 정적.

### static 메서드

- **클래스 메서드(정적 메서드)**
    - `static` 이 붙은 정적 메서드
    - 객체 생성 없이 클래스명 + `.(dot)` + 메서드명 으로 바로 호출 가능
    - 사용하는 이유: 불필요한 객체 생성 없이 편리하게 메서드 사용 가능
    - 정적 메서드 사용법
        - `static` 메서드는 `static` 만 사용할 수 있음
            - 클래스 내부의 기능을 사용할 때 `static` 이 붙은 정적 메서드나 정적 변수만 사용할 수 있음
            - 인스턴스 변수나 인스턴스 메서드는 사용 불가
        - 반대로, 모든 곳에서 호출은 가능
            - 정적 메서드는 공용 기능. 따라서, 접근 제어자만 허락한다면 클래스를 통해 모든 곳에서 `static` 호출 가능


*범위 지정 선택 단축키: `option` + `위쪽 화살표`

*사용한 메서드나 변수의 코드 보기: `command` + `b`

*변수명 한번에 바꾸기: `shift` + `F6`